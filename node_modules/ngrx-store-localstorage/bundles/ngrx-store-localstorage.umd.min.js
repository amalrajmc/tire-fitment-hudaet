!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("deepmerge")):"function"==typeof define&&define.amd?define("ngrx-store-localstorage",["exports","deepmerge"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ngrx-store-localstorage"]={},e.deepmerge)}(this,(function(e,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var n=r(t),o="@ngrx/store/init",i=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/,c=function(e,t){return"string"==typeof t&&i.test(t)?new Date(t):t},a=function(e,t){return t},f=a,s=function(){return"undefined"!=typeof window},u=s,y=function(e){return e.map((function(e){var t=e;if("object"==typeof e&&(t=Object.keys(e)[0]),"string"!=typeof t)throw new TypeError("localStorageSync Unknown Parameter Type: Expected type of string, got "+typeof t);return e}))},p=y,d=function(e,t,r,n){return e.reduce((function(e,o){var i,f,s,u=o,y=n?c:a;if("object"==typeof u&&("function"==typeof o[u=Object.keys(u)[0]]?y=o[u]:(o[u].reviver&&(y=o[u].reviver),o[u].deserialize&&(f=o[u].deserialize)),o[u].encrypt&&o[u].decrypt?"function"==typeof o[u].encrypt&&"function"==typeof o[u].decrypt?s=o[u].decrypt:console.error("Either encrypt or decrypt is not a function on '"+o[u]+"' key object."):(o[u].encrypt||o[u].decrypt)&&console.error("Either encrypt or decrypt function is not present on '"+o[u]+"' key object.")),void 0!==t){var p=t.getItem(r(u));if(p){s&&(p=s(p));var d=new RegExp("{|\\["),l=p;return("null"===p||"true"===p||"false"===p||d.test(p.charAt(0)))&&(l=JSON.parse(p,y)),Object.assign({},e,((i={})[u]=f?f(l):l,i))}}return e}),{})};var l=function(e,t,r,n,o,i){if(i)try{if(!0!==i(e))return}catch(e){if(e instanceof TypeError)return;throw e}t.forEach((function(t){var i,c,a,f=e[t];if("object"==typeof t){var s=Object.keys(t)[0];if(void 0!==(f=e[s])&&t[s]){if(t[s].serialize)f=t[s].serialize(f);else{var u=void 0;t[s].reduce?u=t[s]:t[s].filter&&(u=t[s].filter),u&&(f=function e(t,r){return r.reduce((function(r,n){if("string"==typeof n||"number"==typeof n){var o=null==t?void 0:t[n];void 0!==o&&(r[n]=o)}else for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var c=n[i];r[i]=e(t[i],c)}return r}),{})}(f,u)),t[s].encrypt&&t[s].decrypt?"function"==typeof t[s].encrypt&&(a=t[s].encrypt):(t[s].encrypt||t[s].decrypt)&&console.error("Either encrypt or decrypt function is not present on '"+t[s]+"' key object.")}i=t[s].replacer,c=t[s].space}t=s}if(void 0!==f&&void 0!==r)try{a&&(f=a("string"==typeof f?f:JSON.stringify(f,i,c))),r.setItem(n(t),"string"==typeof f?f:JSON.stringify(f,i,c))}catch(e){console.warn("Unable to save state to localStorage:",e)}else if(void 0===f&&o)try{r.removeItem(n(t))}catch(e){console.warn("Exception on removing/cleaning undefined '"+t+"' state",e)}}))},g=function(e,t,r){if((r.type===o||"@ngrx/store/update-reducers"===r.type)&&t){e=n(e,t,{arrayMerge:function(e,t,r){return t}})}return e};e.dateReviver=c,e.defaultMergeReducer=g,e.localStorageSync=function(e){return function(t){(void 0===e.storage&&!e.checkStorageAvailability||e.checkStorageAvailability&&s())&&(e.storage=localStorage||window.localStorage),void 0===e.storageKeySerializer&&(e.storageKeySerializer=function(e){return e}),void 0===e.restoreDates&&(e.restoreDates=!0);var r=e.mergeReducer;void 0!==r&&"function"==typeof r||(r=g);var n=y(e.keys),i=e.rehydrate?d(n,e.storage,e.storageKeySerializer,e.restoreDates):void 0;return function(c,a){var f;return f=a.type!==o||c?Object.assign({},c):t(c,a),f=r(f,i,a),f=t(f,a),a.type!==o&&l(f,n,e.storage,e.storageKeySerializer,e.removeOnUndefined,e.syncCondition),f}}},e.rehydrateApplicationState=d,e.syncStateUpdate=l,e.ɵ0=f,e.ɵ1=u,e.ɵ2=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngrx-store-localstorage.umd.min.js.map